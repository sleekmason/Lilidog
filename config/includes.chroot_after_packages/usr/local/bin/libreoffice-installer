#!/bin/bash
echo ""
echo ""
echo ""
read -p "   [0;33mLibreoffice Installer[0m

   This will install the full Libreoffice Suite with gtk support 
   and other sensible extras. Hunspell will default to US EN. 
   Other languages available.
   
   Please note that libreoffice-writer is already installed in the
   full versions if all you need is a writer.
   
   --------------------------------------------------------------
   
   [0;32mPlease press enter to install the Libreoffice Suite.[0m
   
   --------------------------------------------------------------
   
   
   Or close this terminal window to quit the install." ;
wget -q --tries=10 --timeout=20 --spider http://google.com
if [ $? -eq 0 ]; then
echo "" 
sudo apt update && sudo apt install libreoffice libreoffice-gtk3 \
hunspell-en-us hyphen-en-us cups-bsd libsane libxrender1 libgl1 libpaper-utils \
fonts-dejavu fonts-liberation2 fonts-linuxlibertine fonts-noto-core fonts-noto-extra &&
sed -i '/Libreoffice,             libreoffice,                       libreoffice-writer/d' ~/.config/jgmenu/mymenu.csv &&
sed -i '/Root Folders,^checkout(rootfiles),folder/a Libreoffice,             libreoffice,                       libreoffice-writer' ~/.config/jgmenu/mymenu.csv &&
sed -i '/Writer,             libreoffice,                       libreoffice-writer/d' ~/.config/jgmenu/mymenu.csv
killall jgmenu
echo ""
echo ""
echo ""
echo "-----------------------------------------------------------"
echo ""
echo "[0;32mAll Finished![0m"
echo ""
echo "[0;33mYou should find a Libreoffice entry in the quickgrab menu [0m" 
echo "" 
echo "" 
echo "[0;32mMenu entries will need to be removed manually if uninstalled." 
echo "See Jgmenu Conf under Configuration in the menu for directions.[0m"
echo ""
echo "-----------------------------------------------------------"
else
echo ""
 echo "   [0;31m-----------------------------------------------------[0m"
 echo ""
 echo "   [0;33mNo Internet connection. Please connect and try again.[0m"
 echo ""
 echo "   [0;31m-----------------------------------------------------[0m"
echo ""
fi
