#!/bin/bash
echo ""
echo ""
echo ""
read -p "   This script is a helper script for you to download and install
   VirtualBox from https://www.virtualbox.org/wiki/Linux_Downloads

   This script grabs the gpg.key and adds the sources for virtualbox 
   before updating and installing, and then disabling the repo.

   Any extra programs associated with VirtualBox, are not 
   a part of this script and will need to be downloaded 
   separately if desired. (Extension pack, etc.)

   -----------------------------------------
   
   Please press enter to install VirtualBox.
   
   ----------------------------------------- 
   
    Or close this terminal window to quit the install." ;
echo ""   
echo ""
sudo wget -O- https://www.virtualbox.org/download/oracle_vbox_2016.asc | sudo gpg --no-default-keyring --keyring gnupg-ring:/etc/apt/trusted.gpg.d/virtualbox.gpg --import
sudo chmod 644 /etc/apt/trusted.gpg.d/virtualbox.gpg
grep -qF "deb" /etc/apt/sources.list.d/virtualbox.list  || echo 'deb [arch=amd64] https://download.virtualbox.org/virtualbox/debian bullseye contrib' |\
sudo tee -a /etc/apt/sources.list.d/virtualbox.list
sudo sed -i '1s/# deb/deb/g' /etc/apt/sources.list.d/virtualbox.list
sudo apt update && sudo apt install --install-recommends virtualbox-6.1 build-essential &&
sed -i '/Virtualbox,         virtualbox,       virtualbox/d' ~/.config/jgmenu/mymenu.csv &&
sed -i '/Root Files,^checkout(rootfiles),folder-documents/a Virtualbox,         virtualbox,       virtualbox' ~/.config/jgmenu/mymenu.csv
killall jgmenu
sudo sed -i '1s/deb/# deb/g' /etc/apt/sources.list.d/virtualbox.list
echo ""
echo "----------------------------------------------------------------"
echo ""
echo "All Finished!"
echo ""
echo "" 
echo "If installed, You should find a new menu entry under 'Quick Grab'"
echo "" 
echo "" 
echo "Menu entries will need to be removed manually if uninstalled." 
echo "See Jgmenu Conf under Configuration in the menu for directions."
echo ""
echo "----------------------------------------------------------------"
