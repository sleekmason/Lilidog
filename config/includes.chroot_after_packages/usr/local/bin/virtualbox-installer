#!/bin/bash
echo ""
echo "                  [0;33mOracle Virtualbox Installer[0m"
echo ""
read -p "   This script will download and install the Oracle edition
   of VirtualBox: https://www.virtualbox.org/wiki/Linux_Downloads

   New sources will be added and toggled active during script use and
   a new menu entry will be placed in the Quick Grab menu.
   
   Any extra programs associated with VirtualBox, are not a part of
   this script and will need to be downloaded separately if desired.
   
   If you would prefer the Debian edition, you will need to install
   Fast Track Repos from the Backports Installer in the Extras menu.

   [0;32m-----------------------------------------------------
   
   Please press enter to install VirtualBox from Oracle.
   
   -----------------------------------------------------[0m
     
    Or close this terminal window to quit the install." ;   
    if : >/dev/tcp/8.8.8.8/53; then
echo ""   
echo ""
sudo wget -O- https://www.virtualbox.org/download/oracle_vbox_2016.asc | sudo gpg --no-default-keyring --keyring gnupg-ring:/etc/apt/trusted.gpg.d/virtualbox.gpg --import
sudo chmod 644 /etc/apt/trusted.gpg.d/virtualbox.gpg
grep -qF "deb" /etc/apt/sources.list.d/virtualbox.list  || echo 'deb [arch=amd64] https://download.virtualbox.org/virtualbox/debian bullseye contrib' |\
sudo tee -a /etc/apt/sources.list.d/virtualbox.list
sudo sed -i '/deb/c deb [arch=amd64] https://download.virtualbox.org/virtualbox/debian bullseye contrib' /etc/apt/sources.list.d/virtualbox.list
sudo apt update && sudo apt install --install-recommends virtualbox-6.1 build-essential &&
sed -i '/Virtualbox,         virtualbox,       virtualbox/d' ~/.config/jgmenu/mymenu.csv &&
sed -i '/Root Folders,^checkout(rootfiles),folder/a Virtualbox,         virtualbox,       virtualbox' ~/.config/jgmenu/mymenu.csv
killall jgmenu
sudo sed -i '/deb/c #deb [arch=amd64] https://download.virtualbox.org/virtualbox/debian bullseye contrib' /etc/apt/sources.list.d/virtualbox.list 
echo ""
echo "----------------------------------------------------------------"
echo ""
echo "[0;32mAll Finished![0m"
echo ""
echo "[0;33mIf installed, You should find a new menu entry under 'Quick Grab'[0m"
echo "" 
echo "[0;32mMenu entries will need to be removed manually if uninstalled." 
echo "See Jgmenu Conf under Configuration in the menu for directions.[0m"
echo ""
echo "----------------------------------------------------------------"
else
echo ""
 echo "   [0;31m-----------------------------------------------------[0m"
 echo ""
 echo "   [0;33mNo internet connection. Please connect and try again.[0m"
 echo ""
 echo "   [0;31m-----------------------------------------------------[0m"
echo ""
fi
